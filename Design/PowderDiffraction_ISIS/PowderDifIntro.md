
Introduction
============

Purpose of this Document: This document describes the detailed design of the new Powder Differaction in the MantidPlot application.
 
Objectives
===========

As we are learning and not fully aware of the objectives that need to be achieved. The describtion will include intial investigation 
that is being carried out, what files, algorithm, workspaces are being used in order to work the old Powder Diffraction by Aziz. 

Detailed Objectives
===================

Basic Objectives
----------------

*	Integrate Powder Diffraction algorithm in Mantid
*	Being able to drive effective codes from previously Powder Diffractions code which have been done by different departments 	
*	Being able to satisfy the demands of the scientists 
  

Previous PowderDif Algorithms
=============================

Mantid Algorithms Used
----------------------

These algorithms were used during the process (in chronological order) of running the previous Powder Diffraction Plug-in 
to Mantid by Aziz. (By exposing the repository to python script in Mantid.property). The new Powder Diffraction could possibly
still using the following algorithms too:

| Mantid Algorithms               | 
| :-----------------------------: | 
| LoadRaw v3                      | 
| MaskBins v1 x5                  | 
| CreateSingleValuedWorkspace v1  | 
| Divide v1                       | 
| Integration v1                  | 
| MaskDetectorsIf v1              | 
| SolidAngle v1                   | 
| CreateSingleValuedWorkspace v1  | 
| Multiply v1                     | 
| Divide v1                       | 
| ConvertUnits v1                 | 
| Integration v1                  |
| Multiply v1                     |
| CreateSingleValuedWorkspace v1  | 
| Divide v1                       | 
| LoadNexusProcessed v1 x3        | 
| MaskBins v1 x5                  | 
| CreateSingleValuedWorkspace v1  | 
| Divide v1                       | 
| Integration v1                  | 
| MaskDetectorsIf v1              | 
| AlignDetectors v1               | 
| Divide v1                       | 
| CreateSingleValuedWorkspace v1  | 
| Multiply v1                     | 
| DiffractionFocussing v2         | 
| CropWorkspace v1 x3             | 
| RebinToWorkspace v1             | 
| Divide v1                       | 
| RebinToWorkspace v1             | 
| Divide v1                       | 
| RebinToWorkspace v1             | 
| Divide v1                       | 
| RebinToWorkspace v1             | 
| Divide v1                       | 
| Rebin v1 x3                     | 
| ConvertUnits v1                 |
| ReplaceSpecialValues v1 x2      | 
| ConvertUnits v1                 | 
| ReplaceSpecialValues v1 x2      | 
| ConvertUnits v1                 | 
| ReplaceSpecialValues v1 x2      | 
| GroupWorkspaces v1              |
| SaveGSS v1 x4                   |
| SaveNexusProcessed v1           |
| SaveFocusedXYE v1 x6            |


Output Files
------------


* These are the final output workspace which are being generated by running the CRY_example.py

| Output Workspace               | 
| :----------------------------: | 
| ResultD-1: MatrixWorkspace     | 
| ResultD-2: MatrixWorkspace     | 
| ResultD-3: MatrixWorkspace     | 
| ResultTOFgrp: TableWorkspace   | 
| totuamps: MatrixWorkspace      | 


Prototype example usage
===============================

```python
import CRY_ini
import CRY_focus

from mantid.simpleapi import config
config['datasearch.searcharchive'] = 'On'
print config['datasearch.searcharchive']
	
expt=CRY_ini.files("hrpd",Analysisdir='test')
#expt.RawDir="C:/AZIZWORK/BigData/HRPD/Bigg"
expt.initialize('cycle_09_2',user = 'tester',prefFile='mtd.pref')
expt.tell()
#------------------------------------
# 1) process single runs, given as 
#     a list of mubers OR ranges (raw):
# eg: "1000 1005 1250-1260" 
#    AND/OR process a range of runs merging data every n runs 
#    (checks for 0 uamps data)
# eg: "1300-1200-5"
# The two options can be used together
# 3) XOR: process several instermediate saves
# eg: s42356 1-3 5
#------------------------------------
#CRY_focus.FocusAll(expt,"43022-43025 43028-43045-3")
CRY_focus.FocusAll(expt,"43022")
# Optional : 
# Skip Normalization & user-defined scale, e.g:
#CRY_focus.FocusAll(expt,"1000 1005 1250-1260" , scale=100, Norm=False)
```

